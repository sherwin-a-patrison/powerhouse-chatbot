<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PowerHouse Chatbot</title>

  <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>

  <style>
    * {margin:0;padding:0;box-sizing:border-box;}

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
      transition: background 0.4s, color 0.4s;
    }

    /* Light theme with bg image */
    body.light {
      background: url("/static/powerhouse-bg.png") no-repeat center/cover;
      color: #000;
      --header-bg:#b71c1c;
      --header-text:#fff;
      --user-msg:#ff5252;
      --bot-msg:#212121;
      --input-bg:rgba(255,255,255,0.9);
      --button-bg:#b71c1c;
    }

    /* Dark theme */
    body.dark {
      background: #000;
      color:#fff;
      --header-bg:#222;
      --header-text:#f5f5f5;
      --user-msg:#b71c1c;
      --bot-msg:#333;
      --input-bg:#555;
      --button-bg:#b71c1c;
    }

    #particles-js {
      position:fixed;
      width:100%;
      height:100%;
      z-index:0;
    }

    #chat-container {
      width:95%;
      max-width:500px;
      height:90vh;
      background:rgba(0,0,0,0.65);
      border-radius:16px;
      box-shadow:0 6px 25px rgba(0,0,0,0.6);
      display:flex;
      flex-direction:column;
      overflow:hidden;
      backdrop-filter:blur(6px);
      z-index:1;
    }

    #chat-header {
      padding:15px;
      background:var(--header-bg);
      color:var(--header-text);
      font-size:20px;
      font-weight:bold;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }

    #theme-toggle {
      background:transparent;
      border:2px solid var(--header-text);
      color:var(--header-text);
      border-radius:20px;
      padding:4px 10px;
      cursor:pointer;
    }

    #messages {
      flex:1;
      overflow-y:auto;
      padding:12px;
      display:flex;
      flex-direction:column;
    }

    .msg {
      margin:6px 0;
      padding:10px 14px;
      border-radius:12px;
      max-width:75%;
      word-wrap:break-word;
      animation:fadeIn 0.3s ease-in-out;
    }
    .user {background:var(--user-msg);align-self:flex-end;color:#000;}
    .bot {background:var(--bot-msg);align-self:flex-start;color:#fff;border:1px solid #b71c1c;}

    #input-area {
      display:flex;
      padding:10px;
      border-top:1px solid #444;
      background:rgba(0,0,0,0.4);
    }
    #userInput {
      flex:1;
      padding:10px;
      border:1px solid #555;
      border-radius:20px;
      font-size:14px;
      outline:none;
      background:var(--input-bg);
    }
    button {
      margin-left:10px;
      padding:10px 16px;
      background:var(--button-bg);
      border:none;
      color:#fff;
      border-radius:20px;
      cursor:pointer;
      font-size:14px;
    }
    button:hover{opacity:0.9;}

    @keyframes fadeIn {
      from{opacity:0;transform:translateY(10px);}
      to{opacity:1;transform:translateY(0);}
    }

    @media(max-width:600px){
      #chat-container{height:95vh;}
      #chat-header{font-size:18px;}
    }
  </style>
</head>
<body class="light">
  <div id="particles-js"></div>

  <div id="chat-container">
    <div id="chat-header">
       PowerHouse Chatbot
      <button id="theme-toggle">üåô</button>
    </div>
    <div id="messages"></div>
    <div id="input-area">
      <input id="userInput" type="text" placeholder="Type message here‚Ä¶" onkeypress="if(event.key==='Enter'){sendMessage()}">
      <button onclick="sendMessage()">Send</button>
    </div>
  </div>

<script>
  // Particle config (glow effect)
  const particlesConf = {
    particles: {
      number:{value:80},
      size:{value:3},
      move:{speed:1.5},
      line_linked:{enable:true,color:"#ff1744",opacity:0.5},
      color:{value:["#ff1744","#d50000","#ff8a80"]}
    },
    interactivity:{
      detect_on:"canvas",
      events:{
        onhover:{enable:true,mode:"grab"},
        onclick:{enable:true,mode:"push"}
      }
    }
  };
  particlesJS("particles-js",particlesConf);

  // Theme toggle
  const body=document.body;
  const btn=document.getElementById("theme-toggle");
  btn.addEventListener("click",()=>{
    body.classList.toggle("dark");
    body.classList.toggle("light");
    btn.textContent=body.classList.contains("dark")?"‚òÄÔ∏è":"üåô";
  });

  // Messaging
  async function sendMessage(){
    const input=document.getElementById("userInput");
    const msg=input.value.trim();
    if(!msg) return;
    addMessage(msg,"user");

    const res=await fetch("https://powerhouse-chatbot.onrender.com/chat",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({message:msg})
    });
    const data=await res.json();
    addMessage(data.reply,"bot");
    input.value="";
  }
  function addMessage(text,sender){
    const d=document.createElement("div");
    d.classList.add("msg",sender);
    d.innerHTML=text;
    document.getElementById("messages").appendChild(d);
    document.getElementById("messages").scrollTop=document.getElementById("messages").scrollHeight;
  }
</script>
</body>
</html>
